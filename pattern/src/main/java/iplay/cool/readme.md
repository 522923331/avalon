# 设计模式六大原则

## 六大原则

设计模式所有原则都是为了达到面向对象设计的可扩展可复用可维护性而出现的。

对于设计模式的原则，不同的书说法不一样，有的6个有的7个，单一职责原则和接口隔离原则多数只提了一个。

开闭原则为最重要的面向对象设计原则，它是面向对象的可复用设计的第一块基石。其他几条，则可以看做是开闭原则的实现方法。 设计模式就是实现了这些原则，从而达到了代码复用、增加可维护性的目的。

## 开闭原则OCP

开闭原则：对扩展开放，对修改关闭。开闭原则为最重要的面向对象设计原则，而抽象化是开闭原则的关键。

## 里氏替换原则LSP

里氏替换原则：任何基类可以出现的地方，子类一定可以出现。
在代码中将一个基类对象替换成它的子类对象，程序不会产生任何错误和异常，反过来则不成立。
里氏替换原则是实现开闭原则的重要方式之一，由于使用基类对象的地方，都可以使用子类对象，因此在程序中尽量使用基类类型来对对象进行定义，而在运行时再确定其子类类型，用子类对象来替换父类对象。
里氏替换原则的另一层含义是，子类可以扩展父类的功能，但是不能改变父类原有的功能。
里氏替换原则继承规则，主要体现在四个方面：
1.子类可以实现父类的抽象方法，但不能覆盖父类的非抽象方法（当然是能的，但是覆盖后就不满足里氏替换原则了）
2.子类中可以增加自己特有的方法。这个规则也变相的解释了为什么子类可以胜任父类的工作，但是父类不能胜任子类的工作。
3.当子类覆盖或者实现父类已经实现的方法时，子类方法的输入参数需要比父类方法的输入参数更宽松，不能相同（相同就是覆盖）。

解释一下：拿人穿衣来说，最里面的衣服应该是最紧的，外面的衣服需要更宽松。
4.当子类方法实现父类的***抽象***方法时，方法的返回值要比父类更严格（小于等于父类范围）。

总结一下：子类实现父类方法时，如果想要满足【任何基类出现的地方，子类一定可以出现】这个场景，就需要满足上面的4条继承原则，就是：子类不能覆盖父类，子类如果要实现父类已实现的方法，就需要形参更宽泛，返回值更狭小。

## 依赖倒置原则DIP

定义：

高层模块不应该依赖于底层模块，两者都应该依赖其抽象。抽象不应该依赖细节，细节应该依赖于抽象。

依赖倒置原则是实现开闭原则的基础，其实就是面向接口编程的解释，理解了面向接口编程，也就理解了依赖倒置原则。

**开闭原则是目标，里氏代换原则是基础，依赖倒转原则是手段**

## 接口隔离原则ISP

定义：使用多个专门的接口，而不使用一个涵盖所有功能的总接口。即客户端不应该依赖那些它不需要的接口。设计接口的时候要精简单一，不要建立庞大臃肿的接口，尽量细化接口，接口中的方法尽量少。

每一个接口应该承担一种相对独立的角色，不干不该干的事。

与单一职责原则的区别：

1. 单一职责原则注重的是职责；而接口隔离原则注重的是对接口依赖的隔离。
2. 单一职责原则主要是约束类，其次才是接口和方法，它针对的是程序中的实现和细节；而接口隔离原则主要约束接口，主要针对抽象，针对程序整体框架的构建。

注意点：

* 接口尽量小，但是要有限度。对接口进行细化可以提高程序设计灵活性是不争的事实，但是如果过小，则会造成接口数量过多，使设计复杂化。所以一定要适度。
* 为依赖接口的类定制服务，只暴露给调用的类它需要的方法，它不需要的方法则隐藏起来。只有专注地为一个模块提供定制服务，才能建立最小的依赖关系。
* 提高内聚，减少对外交互。使接口用最少的方法去完成最多的事情。

## 合成/聚合复用原则CARP

定义：

合成/聚合复用原则经常又叫做合成复用原则。该原则就是在一个新的对象里面使用一些已有的对象，使之成为新对象的一部分；新的对象通过向这些对象的委派达到复用已有功能的目的。尽量使用对象组合，而不是继承来达到复用的目的。

概述：

在面向对象设计中，可以通过两种方法在不同的环境中复用已有的设计和实现，即**通过组合/聚合关系或通过继承**，但首先应该考虑使用组合/聚合，组合/聚合可以使系统更加灵活，降低类与类之间的耦合度，一个类的变化对其他类造成的影响相对较少；其次才考虑继承，在使用继承时，需要严格遵循里氏替换原则，有效使用继承会有助于对问题的理解，降低复杂度，而滥用继承反而会增加系统构建和维护的难度以及系统的复杂度，因此需要慎重使用继承复用。

* 组合（Composition）contains-a关系

​		组合关系表示事物的整体/部分关系的较强的情况，组合关系的类具有相同的生命周期。比如类A中包含了类B的一个引用b，当类A消亡时，b这个引用所指向的对象也同时消亡，这种情况称为组合，比如人和大脑。

* 聚合（Aggregation）has-a关系
  聚合关系表示事物的整体/部分关系的较弱情况，当类A对象消亡时，类B不会消亡，因为可能还有其他对象指向了它。比如人和电脑。
* 生动的案例
  一只野狼单独很难捕获到猎物，所以它们一直过着群居的生活，不容易被饿死，这样就有了狼群。每一只野狼都有自己的狼群，每个狼群都有好多野狼，野狼与狼群的这种关系就可以称之为聚合，另外每只野狼都有4条狼腿，野狼与狼腿的关系就叫做组合。

## 迪米特法则LOD

定义：

一个软件实体，应该尽可能少地与其它实体发生相互作用

详细概述：

迪米特法则又叫最少知道原则，通俗来讲，就是一个类对自己的知道的类越少越好。也就是说，对于被依赖的类来说，无论逻辑多么复杂，都尽量地的将逻辑封装在类的内部，对外除了提供的public方法，不对外泄漏任何信息。

其它定义形式：

迪米特法则还有一个英文解释是：**talk only to your immediate friends**：**只与直接的朋友交流。**对于一个对象，其朋友包括：成员属性、方法入参中的类对象、方法返回值中的类、如果当前对象的成员对象是一个集合，那么集合中的元素也都是朋友。

任何一个对象，如果满足上面的条件之一，就是当前对象的“朋友”，否则就是“陌生人”（如方法体内部的类对象）。

在应用迪米特法则时，一个对象只能与直接朋友发生交互，否则就是违法了迪米特原则。
